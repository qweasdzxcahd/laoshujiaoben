-- TeTraX 作弊菜单 - 完整整合版
-- 使用 WindUI 库构建

-- ========== 基础配置 ==========
local myconfigs = { "zzzzosky#1", "TeTraXDev", "zzzzzosky" }
getgenv().setColor = Color3.fromRGB(252, 3, 90)
getgenv().Antifog = true

-- 设置FPS上限
if setfpscap then
    setfpscap(900)
end

-- ========== 加载WindUI库 ==========
local success, WindUI = pcall(function()
    local response = game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua", true)
    if response and #response > 0 then
        return loadstring(response)()
    else
        error("Failed to load WindUI: Empty response")
    end
end)

if not success then
    warn("WindUI加载失败: "..tostring(WindUI))
    return
end

-- ========== 核心功能函数 ==========
-- 抓取功能
function grabfunc(p93)
    local success, result = pcall(function()
        local signalFunc = require(game:GetService("ReplicatedStorage").devv.client.Helpers.remotes.Signal).FireServer
        local upvalues = getupvalue(signalFunc, 1)
        if upvalues and upvalues.grabPlayer then
            game:GetService("ReplicatedStorage").devv.remoteStorage[tostring(upvalues.grabPlayer)]:FireServer(unpack({p93}))
        end
    end)
    if not success then warn("grabfunc错误: "..tostring(result)) end
end

-- 获取玩家装备
function getPlayerEquipped()
    local equippedItem = nil
    pcall(function()
        local v3Items = require(game:GetService("ReplicatedStorage").devv.client.Objects.v3item)
        equippedItem = getupvalues(v3Items.inventory.setEquipped)[7].equipped
    end)
    return equippedItem
end

-- 获取玩家列表
local function getPlayers()
    local players = {}
    for _, player in ipairs(game:GetService("Players"):GetPlayers()) do
        if player ~= game:GetService("Players").LocalPlayer then
            table.insert(players, player.Name)
        end
    end
    return players
end

-- ========== UI界面构建 ==========
-- 创建主窗口
local window = WindUI:CreateWindow({
    Title = "TeTraX",
    Center = true,
    AutoShow = true,
    Size = UDim2.new(0, 500, 0, 400),
    Theme = "Dark"
})

-- 添加功能标签页
local mainTab = window:AddTab("Main")
local playerTab = window:AddTab("Player")
local teleportTab = window:AddTab("Teleport")
local magicTab = window:AddTab("Magic")
local cashTab = window:AddTab("Cash")
local itemTab = window:AddTab("Items")
local notifTab = window:AddTab("Notifications")
local scanTab = window:AddTab("Scans")

-- ========== 主标签页功能 ==========
mainTab:AddSection("核心功能")
mainTab:AddButton({
    Title = "加载作弊",
    Description = "初始化所有作弊功能",
    Callback = function()
        print("作弊功能已加载!")
    end
})

mainTab:AddToggle({
    Title = "无敌模式",
    Default = false,
    Callback = function(value)
        getgenv().GodMode = value
        print("无敌模式: "..(value and "开启" or "关闭"))
    end
})

-- ========== 玩家标签页功能 ==========
playerTab:AddSection("玩家属性")
playerTab:AddSlider({
    Title = "移动速度",
    Min = 16,
    Max = 200,
    Default = 16,
    Callback = function(value)
        local character = game:GetService("Players").LocalPlayer.Character
        if character and character:FindFirstChild("Humanoid") then
            character.Humanoid.WalkSpeed = value
        end
    end
})

playerTab:AddSlider({
    Title = "跳跃高度",
    Min = 50,
    Max = 300,
    Default = 50,
    Callback = function(value)
        local character = game:GetService("Players").LocalPlayer.Character
        if character and character:FindFirstChild("Humanoid") then
            character.Humanoid.JumpPower = value
        end
    end
})

-- ========== 传送标签页功能 ==========
teleportTab:AddSection("位置传送")
teleportTab:AddButton({
    Title = "传送到出生点",
    Callback = function()
        local spawn = game:GetService("Workspace"):FindFirstChild("SpawnLocation")
        if spawn then
            local character = game:GetService("Players").LocalPlayer.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = spawn.CFrame
            end
        else
            warn("未找到出生点!")
        end
    end
})

teleportTab:AddDropdown({
    Title = "传送到玩家",
    Options = getPlayers(),
    Callback = function(selected)
        local targetPlayer = game:GetService("Players"):FindFirstChild(selected)
        if targetPlayer and targetPlayer.Character then
            local character = game:GetService("Players").LocalPlayer.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = targetPlayer.Character:FindFirstChild("HumanoidRootPart").CFrame
            end
        end
    end
})

-- ========== 自动更新玩家列表 ==========
game:GetService("Players").PlayerAdded:Connect(function(player)
    teleportTab:UpdateDropdown("传送到玩家", {Options = getPlayers()})
end)

game:GetService("Players").PlayerRemoving:Connect(function(player)
    teleportTab:UpdateDropdown("传送到玩家", {Options = getPlayers()})
end)

-- ========== 其他功能标签页 ==========
-- 魔法功能
magicTab:AddSection("魔法能力")
magicTab:AddToggle({
    Title = "无限魔法",
    Default = false,
    Callback = function(value)
        getgenv().UnlimitedMagic = value
    end
})

-- 现金功能
cashTab:AddSection("现金作弊")
cashTab:AddToggle({
    Title = "自动收集现金",
    Default = false,
    Callback = function(value)
        getgenv().AutoCollectCash = value
    end
})

-- 物品功能
itemTab:AddSection("物品作弊")
itemTab:AddButton({
    Title = "获取所有物品",
    Callback = function()
        print("尝试获取所有物品...")
    end
})

-- ========== 初始化UI ==========
WindUI:Init()

print("TeTraX作弊菜单已成功加载!")
